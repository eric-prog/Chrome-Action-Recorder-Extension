<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Altera Recorder</title>
    <style>
      body { font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 0; width: 420px; height: 600px; overflow: hidden; }
      header { display:flex; align-items:center; justify-content:space-between; padding:8px 12px; border-bottom:1px solid #eee; }
      .status { font-size: 13px; color: #555; display:flex; align-items:center; gap:8px; }
      .dotLive { width:10px; height:10px; border-radius:50%; background:#aaa; box-shadow:0 0 0 0 rgba(255,0,0,0.7); }
      .recording .dotLive { background:#d93025; animation: pulse 1.5s infinite; }
      @keyframes pulse { 0%{ box-shadow:0 0 0 0 rgba(217,48,37,0.7);} 70%{ box-shadow:0 0 0 10px rgba(217,48,37,0);} 100%{ box-shadow:0 0 0 0 rgba(217,48,37,0);} }
      main { padding: 8px 12px; height: calc(100vh - 80px); overflow-y: auto; }
      .row { display:flex; gap:10px; margin-bottom:10px; }
      button { padding:8px 12px; border-radius:8px; border:1px solid #ddd; background:#fafafa; cursor:pointer; }
      button.primary { background:#1a73e8; color:#fff; border-color:#1a73e8; }
      input, select { padding:8px 10px; border:1px solid #ddd; border-radius:8px; }
      select:disabled { background:#f5f5f5; color:#999; cursor:not-allowed; }
      .timeline { max-height: 220px; overflow:auto; border:1px solid #eee; border-radius:10px; padding:8px; }
      .step { display:flex; gap:10px; align-items:center; padding:8px; border-radius:8px; }
      .step + .step { border-top:1px solid #f1f1f1; }
      .dot { width:12px; height:12px; border-radius:50%; background:#1a73e8; }
      .meta { font-size:12px; color:#555; }
      .gallery { display: flex; flex-direction: column; gap:12px; margin-top:12px; }
      .thumb { display:flex; gap:12px; border:1px solid #eee; border-radius:8px; padding:12px; align-items:center; }
      .thumb img { width:80px; height:60px; object-fit:cover; background:#f5f5f5; border-radius:6px; flex-shrink:0; }
      .thumb-content { flex:1; }
      .thumb-title { font-weight:600; margin-bottom:4px; }
      .thumb-actions { display:flex; gap:8px; margin-top:8px; }
      .thumb-actions button { padding:4px 8px; font-size:12px; }
      textarea { width: 100%; height: 140px; }
    </style>
  </head>
  <body>
    <header>
      <div class="status" id="status"><div class="dotLive" id="statusDot"></div><div id="statusText">Idle</div></div>
      <div class="row" style="margin:0;">
        <button id="btnDashboard" class="primary">Dashboard</button>
        <button id="btnRecorder">Recorder</button>
      </div>
    </header>
    <!-- DASHBOARD VIEW (default) -->
    <main id="dashboardView" style="display:block; padding: 12px;">
      <div class="row" style="justify-content:space-between;">
        <div class="meta" id="dbCount">0 recordings</div>
        <button id="newRecording">New recording</button>
      </div>
      <div class="gallery" id="dbList"></div>
    </main>
    <!-- RECORDER VIEW -->
    <main id="recorderView" style="display:none;">
      <div class="row">
        <input id="recName" placeholder="Recording name" style="flex:1;" />
        <button id="save">Save</button>
      </div>
      <div class="row">
        <select id="recList" style="flex:1;"></select>
        <button id="load">Load</button>
        <button id="del">Delete</button>
      </div>
      <div class="row">
        <button id="start" class="primary">Start Recording</button>
        <button id="stop" style="display:none;">Stop Recording</button>
      </div>
      <div class="timeline" id="timeline"></div>
      <div class="row">
        <button id="refresh">Refresh</button>
        <button id="replayInline" class="primary">Replay</button>
        <button id="download">Export JSON</button>
        <button id="clear">Clear</button>
      </div>
      <div id="toast" style="position:fixed; bottom:10px; right:10px; background:rgba(0,0,0,0.8); color:#fff; padding:8px 12px; border-radius:8px; font-size:12px; display:none;">Saved</div>
      <textarea id="events" placeholder="Recorded events will appear here..."></textarea>
    </main>
    <script src="popup.js"></script>
  </body>
  </html>


